import {
  HomeIcon,
  BarChart2Icon,
  SettingsIcon,
  MenuIcon,
  XIcon,
} from "lucide-react"
import clsx from "clsx"
import { AudioSelector, ProcessButton } from "./index"
import { useDashboard } from "../../context/DashboardContext"
import Link from "next/link"
import { useState } from "react"

const navItems = [
  { label: "Home", icon: HomeIcon, href: "#" },
  { label: "Reports", icon: BarChart2Icon, href: "#" },
  { label: "Settings", icon: SettingsIcon, href: "#" },
]

type SidebarProps = {
  collapsed: boolean
  hovered: boolean
  toggleSidebar: () => void
  setHovered: (hovered: boolean) => void
}

export default function Sidebar({
  collapsed,
  hovered,
  toggleSidebar,
  setHovered,
}: SidebarProps) {
  const {
    selectedAudio,
    setSelectedAudio,
    graphData,
    setGraphData,
    loading,
    setLoading,
  } = useDashboard()
const [isProgress, setIsProgress] = useState(0)
  const isExpanded = !collapsed

  const handleMenuClick = () => {
    // Collapse sidebar only if it's expanded
    if (isExpanded) {
      toggleSidebar()
    }
  }

  const menuItems = [

    {
      id: "AudioFilesUpload",
      label: "Audio Files Upload",
      icon: "AiIcon",
      href: "/audio-upload",
    },
    {
      id: "UploadFiles",
      label: "Upload Files",
      icon: "AiIcon",
      href: "/UploadFiles",
    },
    {
      id: "AgentSummary",
      label: "Reports",
      icon: "AiIcon",
      href: "/agent-summary",
    },
  ]

  return (
    <aside
      className={clsx(
        "h-screen fixed top-0 left-0 bg-white border-r shadow transition-all duration-300 ease-in-out",
        isExpanded ? "w-[306px]" : "w-16"
      )}
    >
      <div className="flex justify-end p-3">
        <button
          onClick={toggleSidebar}
          className="text-gray-600 hover:text-gray-900"
        >
          {isExpanded ? <XIcon /> : <MenuIcon />}
        </button>
      </div>

      {isExpanded && (
        <div className="p-4 space-y-4 mt-6 border-t pt-4 batch-summary">
          <Link
            href="/"
            className=" flex gap-3 items-center block w-full px-4 py-2 text-left hover:bg-gray-100 rounded-md transition-colors"
          >
            <span>
              <svg
                width="15"
                height="20"
                viewBox="0 0 15 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M7.5 12.6316C9.27862 12.6316 10.7142 11.221 10.7142 9.47371V3.1579C10.7142 1.41053 9.27862 0 7.5 0C5.72137 0 4.28571 1.41053 4.28571 3.1579V9.47371C4.28571 11.221 5.72137 12.6316 7.5 12.6316ZM6.42863 3.1579C6.42863 2.57895 6.91075 2.10527 7.5 2.10527C8.08925 2.10527 8.57137 2.57895 8.57137 3.1579V9.47371C8.57137 10.0632 8.1 10.5263 7.5 10.5263C6.91075 10.5263 6.42863 10.0526 6.42863 9.47371V3.1579ZM13.1786 9.47371H15C15 13.0631 12.0857 16.0316 8.57137 16.5474V20H6.42863V16.5474C2.91429 16.0316 0 13.0631 0 9.47371H1.82142C1.82142 12.6316 4.54286 14.8421 7.5 14.8421C10.4571 14.8421 13.1786 12.6316 13.1786 9.47371Z"
                  fill="#34334B"
                />
              </svg>
            </span>
            <span>Call Audio</span>
          </Link>
          <AudioSelector
            selectedAudio={selectedAudio}
            setSelectedAudio={setSelectedAudio}
            clearGraphData={() => setGraphData([])}
          />

          <ProcessButton
            selectedAudio={selectedAudio}
            setGraphData={setGraphData}
            loading={loading}
            setLoading={setLoading}
            setProgress={setIsProgress}
          />

          {/* Menu Items */}
          <div className="space-y-2">
            {menuItems.map((menu) => (
              <Link
                key={menu.id}
                href={menu.href}
                onClick={handleMenuClick}
                className="flex gap-3 items-center w-full px-4 py-2 text-left hover:bg-gray-100 rounded-md transition-colors"
              >
                <span>
                  {menu.id === "FilesUpload" && (
                  <svg
                    width="20"
                    height="16"
                    viewBox="0 0 20 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      fill-rule="evenodd"
                      clip-rule="evenodd"
                      d="M6.19048 6C6.19048 3.79086 7.89606 2 10 2C12.1039 2 13.8095 3.79086 13.8095 6V7H14.7619C16.6029 7 18.0952 8.567 18.0952 10.5C18.0952 12.433 16.6029 14 14.7619 14H13.8095C13.2835 14 12.8571 14.4477 12.8571 15C12.8571 15.5523 13.2835 16 13.8095 16H14.7619C17.6549 16 20 13.5376 20 10.5C20 7.7793 18.1186 5.51997 15.6472 5.07824C15.225 2.20213 12.8574 0 10 0C7.14261 0 4.77506 2.20213 4.35272 5.07824C1.88144 5.51997 0 7.7793 0 10.5C0 13.5376 2.34517 16 5.2381 16H6.19048C6.71646 16 7.14286 15.5523 7.14286 15C7.14286 14.4477 6.71646 14 6.19048 14H5.2381C3.39714 14 1.90476 12.433 1.90476 10.5C1.90476 8.567 3.39714 7 5.2381 7H6.19048V6ZM13.5306 9.2929L10.6734 6.2929C10.3015 5.90237 9.69848 5.90237 9.32657 6.2929L6.46942 9.2929C6.09749 9.6834 6.09749 10.3166 6.46942 10.7071C6.84135 11.0976 7.44436 11.0976 7.8163 10.7071L9.04762 9.4142V15C9.04762 15.5523 9.474 16 10 16C10.526 16 10.9524 15.5523 10.9524 15V9.4142L12.1837 10.7071C12.5556 11.0976 13.1587 11.0976 13.5306 10.7071C13.9025 10.3166 13.9025 9.6834 13.5306 9.2929Z"
                      fill="#34334B"
                    />
                  </svg>
                  )}
                  {menu.id === "AudioFilesUpload" && (
                  <svg
                    width="20"
                    height="16"
                    viewBox="0 0 20 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      fillRule="evenodd"
                      clipRule="evenodd"
                      d="M6.19048 6C6.19048 3.79086 7.89606 2 10 2C12.1039 2 13.8095 3.79086 13.8095 6V7H14.7619C16.6029 7 18.0952 8.567 18.0952 10.5C18.0952 12.433 16.6029 14 14.7619 14H13.8095C13.2835 14 12.8571 14.4477 12.8571 15C12.8571 15.5523 13.2835 16 13.8095 16H14.7619C17.6549 16 20 13.5376 20 10.5C20 7.7793 18.1186 5.51997 15.6472 5.07824C15.225 2.20213 12.8574 0 10 0C7.14261 0 4.77506 2.20213 4.35272 5.07824C1.88144 5.51997 0 7.7793 0 10.5C0 13.5376 2.34517 16 5.2381 16H6.19048C6.71646 16 7.14286 15.5523 7.14286 15C7.14286 14.4477 6.71646 14 6.19048 14H5.2381C3.39714 14 1.90476 12.433 1.90476 10.5C1.90476 8.567 3.39714 7 5.2381 7H6.19048V6ZM13.5306 9.2929L10.6734 6.2929C10.3015 5.90237 9.69848 5.90237 9.32657 6.2929L6.46942 9.2929C6.09749 9.6834 6.09749 10.3166 6.46942 10.7071C6.84135 11.0976 7.44436 11.0976 7.8163 10.7071L9.04762 9.4142V15C9.04762 15.5523 9.474 16 10 16C10.526 16 10.9524 15.5523 10.9524 15V9.4142L12.1837 10.7071C12.5556 11.0976 13.1587 11.0976 13.5306 10.7071C13.9025 10.3166 13.9025 9.6834 13.5306 9.2929Z"
                      fill="#34334B"
                    />
                  </svg>
                   )}
                   {menu.id === "UploadFiles" && (
                  <svg
                    width="20"
                    height="16"
                    viewBox="0 0 20 16"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      fillRule="evenodd"
                      clipRule="evenodd"
                      d="M6.19048 6C6.19048 3.79086 7.89606 2 10 2C12.1039 2 13.8095 3.79086 13.8095 6V7H14.7619C16.6029 7 18.0952 8.567 18.0952 10.5C18.0952 12.433 16.6029 14 14.7619 14H13.8095C13.2835 14 12.8571 14.4477 12.8571 15C12.8571 15.5523 13.2835 16 13.8095 16H14.7619C17.6549 16 20 13.5376 20 10.5C20 7.7793 18.1186 5.51997 15.6472 5.07824C15.225 2.20213 12.8574 0 10 0C7.14261 0 4.77506 2.20213 4.35272 5.07824C1.88144 5.51997 0 7.7793 0 10.5C0 13.5376 2.34517 16 5.2381 16H6.19048C6.71646 16 7.14286 15.5523 7.14286 15C7.14286 14.4477 6.71646 14 6.19048 14H5.2381C3.39714 14 1.90476 12.433 1.90476 10.5C1.90476 8.567 3.39714 7 5.2381 7H6.19048V6ZM13.5306 9.2929L10.6734 6.2929C10.3015 5.90237 9.69848 5.90237 9.32657 6.2929L6.46942 9.2929C6.09749 9.6834 6.09749 10.3166 6.46942 10.7071C6.84135 11.0976 7.44436 11.0976 7.8163 10.7071L9.04762 9.4142V15C9.04762 15.5523 9.474 16 10 16C10.526 16 10.9524 15.5523 10.9524 15V9.4142L12.1837 10.7071C12.5556 11.0976 13.1587 11.0976 13.5306 10.7071C13.9025 10.3166 13.9025 9.6834 13.5306 9.2929Z"
                      fill="#34334B"
                    />
                  </svg>
                   )}
                    {/* {(menu.id === "AgentDetails" || menu.id === "AgentSummary") && ( */}
                    {(menu.id === "AgentSummary") && (
                   <svg width="24" height="26" viewBox="0 0 24 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 0.979004C14.3789 0.979007 16.6607 1.92385 18.3428 3.60596C19.8392 5.10247 20.7503 7.07373 20.9336 9.16553C21.6562 9.32439 22.3251 9.68693 22.8564 10.2183C23.5885 10.9505 24 11.9435 24 12.979V15.0024C24 16.038 23.5887 17.0319 22.8564 17.7642C22.3341 18.2865 21.6783 18.6432 20.9697 18.8062V19.0952C20.9663 20.668 20.3389 22.1756 19.2256 23.2866C18.1122 24.3976 16.6032 25.021 15.0303 25.021V23.2729C16.1402 23.273 17.2046 22.8323 17.9902 22.0483C18.7754 21.2648 19.2178 20.2024 19.2207 19.0933V18.9077H18.3018C17.2043 21.2958 14.7944 22.9554 11.9951 22.9556C9.19563 22.9556 6.78505 21.2959 5.6875 18.9077H3.9043C2.8689 18.9076 1.87571 18.4963 1.14355 17.7642C0.411296 17.0319 2.61345e-06 16.038 0 15.0024V12.979C7.25574e-06 12.4663 0.100708 11.9585 0.296875 11.4849C0.493066 11.0112 0.781069 10.5808 1.14355 10.2183C1.50606 9.85575 1.93653 9.5678 2.41016 9.37158C2.62245 9.28365 2.84208 9.21567 3.06543 9.1665C3.24848 7.07432 4.16051 5.10272 5.65723 3.60596C7.33934 1.92384 9.62114 0.979008 12 0.979004ZM11.9951 6.7749C9.12842 6.77491 6.80284 9.10112 6.80273 11.9722V16.0093C6.80274 18.8804 9.12835 21.2065 11.9951 21.2065C14.8617 21.2063 17.1865 18.8803 17.1865 16.0093V11.9722C17.1864 9.10126 14.8616 6.77514 11.9951 6.7749ZM3.9043 10.8228C3.62128 10.8228 3.34058 10.8785 3.0791 10.9868C2.81763 11.0952 2.58002 11.2545 2.37988 11.4546C2.17975 11.6548 2.02044 11.8923 1.91211 12.1538C1.80378 12.4154 1.74805 12.6959 1.74805 12.979V15.0024C1.74805 15.5743 1.9755 16.1235 2.37988 16.5278C2.78416 16.9321 3.33259 17.1596 3.9043 17.1597H5.05469V10.8228H3.9043ZM18.9453 17.1587H20.0957C20.6674 17.1586 21.2158 16.9321 21.6201 16.5278C22.0245 16.1234 22.252 15.5743 22.252 15.0024V12.979C22.252 12.4072 22.0244 11.8589 21.6201 11.4546C21.2158 11.0503 20.6674 10.8229 20.0957 10.8228H18.9453V17.1587ZM12 2.72705C10.0848 2.72705 8.24779 3.48805 6.89355 4.84229C5.74705 5.98883 5.0282 7.48168 4.83398 9.07471H5.6875C6.78494 6.68625 9.19544 5.02686 11.9951 5.02686C14.7946 5.02703 17.2044 6.6864 18.3018 9.07471H19.166C18.9718 7.48168 18.2529 5.98883 17.1064 4.84229C15.7522 3.48805 13.9152 2.72705 12 2.72705Z" fill="#34334B"/>
                  </svg>
                  )}
                </span>
                
                <span className="text-sm font-medium text-gray-700">
                  {menu.label}
                </span>
              </Link>
            ))}
          </div>
        </div>
      )}
      {!isExpanded && (
        <>
          <Link
            href="/"
            className="justify-center flex gap-3 items-center block w-full px-4 py-2 text-left hover:bg-gray-100 rounded-md transition-colors mb-6 mt-12 h-[48px]"
          >
            <span>
              <svg
                width="15"
                height="20"
                viewBox="0 0 15 20"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M7.5 12.6316C9.27862 12.6316 10.7142 11.221 10.7142 9.47371V3.1579C10.7142 1.41053 9.27862 0 7.5 0C5.72137 0 4.28571 1.41053 4.28571 3.1579V9.47371C4.28571 11.221 5.72137 12.6316 7.5 12.6316ZM6.42863 3.1579C6.42863 2.57895 6.91075 2.10527 7.5 2.10527C8.08925 2.10527 8.57137 2.57895 8.57137 3.1579V9.47371C8.57137 10.0632 8.1 10.5263 7.5 10.5263C6.91075 10.5263 6.42863 10.0526 6.42863 9.47371V3.1579ZM13.1786 9.47371H15C15 13.0631 12.0857 16.0316 8.57137 16.5474V20H6.42863V16.5474C2.91429 16.0316 0 13.0631 0 9.47371H1.82142C1.82142 12.6316 4.54286 14.8421 7.5 14.8421C10.4571 14.8421 13.1786 12.6316 13.1786 9.47371Z"
                  fill="#34334B"
                />
              </svg>
            </span>
          </Link>
          <Link
            href="/audio-upload"
            className="justify-center flex gap-3 items-center block w-full px-4 py-2 text-left hover:bg-gray-100 rounded-md transition-colors h-[48px]"
          >
            <span>
              <svg
                width="20"
                height="16"
                viewBox="0 0 20 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M6.19048 6C6.19048 3.79086 7.89606 2 10 2C12.1039 2 13.8095 3.79086 13.8095 6V7H14.7619C16.6029 7 18.0952 8.567 18.0952 10.5C18.0952 12.433 16.6029 14 14.7619 14H13.8095C13.2835 14 12.8571 14.4477 12.8571 15C12.8571 15.5523 13.2835 16 13.8095 16H14.7619C17.6549 16 20 13.5376 20 10.5C20 7.7793 18.1186 5.51997 15.6472 5.07824C15.225 2.20213 12.8574 0 10 0C7.14261 0 4.77506 2.20213 4.35272 5.07824C1.88144 5.51997 0 7.7793 0 10.5C0 13.5376 2.34517 16 5.2381 16H6.19048C6.71646 16 7.14286 15.5523 7.14286 15C7.14286 14.4477 6.71646 14 6.19048 14H5.2381C3.39714 14 1.90476 12.433 1.90476 10.5C1.90476 8.567 3.39714 7 5.2381 7H6.19048V6ZM13.5306 9.2929L10.6734 6.2929C10.3015 5.90237 9.69848 5.90237 9.32657 6.2929L6.46942 9.2929C6.09749 9.6834 6.09749 10.3166 6.46942 10.7071C6.84135 11.0976 7.44436 11.0976 7.8163 10.7071L9.04762 9.4142V15C9.04762 15.5523 9.474 16 10 16C10.526 16 10.9524 15.5523 10.9524 15V9.4142L12.1837 10.7071C12.5556 11.0976 13.1587 11.0976 13.5306 10.7071C13.9025 10.3166 13.9025 9.6834 13.5306 9.2929Z"
                  fill="#34334B"
                />
              </svg>
            </span>
          </Link>
          <Link
            href="/UploadFiles"
            className="justify-center flex gap-3 items-center w-full px-4 py-2 text-left hover:bg-gray-100 rounded-md transition-colors h-[48px]"
          >
            <span>
             <svg
                width="20"
                height="16"
                viewBox="0 0 20 16"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  fillRule="evenodd"
                  clipRule="evenodd"
                  d="M6.19048 6C6.19048 3.79086 7.89606 2 10 2C12.1039 2 13.8095 3.79086 13.8095 6V7H14.7619C16.6029 7 18.0952 8.567 18.0952 10.5C18.0952 12.433 16.6029 14 14.7619 14H13.8095C13.2835 14 12.8571 14.4477 12.8571 15C12.8571 15.5523 13.2835 16 13.8095 16H14.7619C17.6549 16 20 13.5376 20 10.5C20 7.7793 18.1186 5.51997 15.6472 5.07824C15.225 2.20213 12.8574 0 10 0C7.14261 0 4.77506 2.20213 4.35272 5.07824C1.88144 5.51997 0 7.7793 0 10.5C0 13.5376 2.34517 16 5.2381 16H6.19048C6.71646 16 7.14286 15.5523 7.14286 15C7.14286 14.4477 6.71646 14 6.19048 14H5.2381C3.39714 14 1.90476 12.433 1.90476 10.5C1.90476 8.567 3.39714 7 5.2381 7H6.19048V6ZM13.5306 9.2929L10.6734 6.2929C10.3015 5.90237 9.69848 5.90237 9.32657 6.2929L6.46942 9.2929C6.09749 9.6834 6.09749 10.3166 6.46942 10.7071C6.84135 11.0976 7.44436 11.0976 7.8163 10.7071L9.04762 9.4142V15C9.04762 15.5523 9.474 16 10 16C10.526 16 10.9524 15.5523 10.9524 15V9.4142L12.1837 10.7071C12.5556 11.0976 13.1587 11.0976 13.5306 10.7071C13.9025 10.3166 13.9025 9.6834 13.5306 9.2929Z"
                  fill="#34334B"
                />
              </svg>
            </span>
          </Link>
          <Link
            href="/agent-summary"
            className="justify-center flex gap-3 items-center w-full px-4 py-2 text-left hover:bg-gray-100 rounded-md transition-colors h-[48px]"
          >
            <span>
              <svg width="24" height="26" viewBox="0 0 24 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 0.979004C14.3789 0.979007 16.6607 1.92385 18.3428 3.60596C19.8392 5.10247 20.7503 7.07373 20.9336 9.16553C21.6562 9.32439 22.3251 9.68693 22.8564 10.2183C23.5885 10.9505 24 11.9435 24 12.979V15.0024C24 16.038 23.5887 17.0319 22.8564 17.7642C22.3341 18.2865 21.6783 18.6432 20.9697 18.8062V19.0952C20.9663 20.668 20.3389 22.1756 19.2256 23.2866C18.1122 24.3976 16.6032 25.021 15.0303 25.021V23.2729C16.1402 23.273 17.2046 22.8323 17.9902 22.0483C18.7754 21.2648 19.2178 20.2024 19.2207 19.0933V18.9077H18.3018C17.2043 21.2958 14.7944 22.9554 11.9951 22.9556C9.19563 22.9556 6.78505 21.2959 5.6875 18.9077H3.9043C2.8689 18.9076 1.87571 18.4963 1.14355 17.7642C0.411296 17.0319 2.61345e-06 16.038 0 15.0024V12.979C7.25574e-06 12.4663 0.100708 11.9585 0.296875 11.4849C0.493066 11.0112 0.781069 10.5808 1.14355 10.2183C1.50606 9.85575 1.93653 9.5678 2.41016 9.37158C2.62245 9.28365 2.84208 9.21567 3.06543 9.1665C3.24848 7.07432 4.16051 5.10272 5.65723 3.60596C7.33934 1.92384 9.62114 0.979008 12 0.979004ZM11.9951 6.7749C9.12842 6.77491 6.80284 9.10112 6.80273 11.9722V16.0093C6.80274 18.8804 9.12835 21.2065 11.9951 21.2065C14.8617 21.2063 17.1865 18.8803 17.1865 16.0093V11.9722C17.1864 9.10126 14.8616 6.77514 11.9951 6.7749ZM3.9043 10.8228C3.62128 10.8228 3.34058 10.8785 3.0791 10.9868C2.81763 11.0952 2.58002 11.2545 2.37988 11.4546C2.17975 11.6548 2.02044 11.8923 1.91211 12.1538C1.80378 12.4154 1.74805 12.6959 1.74805 12.979V15.0024C1.74805 15.5743 1.9755 16.1235 2.37988 16.5278C2.78416 16.9321 3.33259 17.1596 3.9043 17.1597H5.05469V10.8228H3.9043ZM18.9453 17.1587H20.0957C20.6674 17.1586 21.2158 16.9321 21.6201 16.5278C22.0245 16.1234 22.252 15.5743 22.252 15.0024V12.979C22.252 12.4072 22.0244 11.8589 21.6201 11.4546C21.2158 11.0503 20.6674 10.8229 20.0957 10.8228H18.9453V17.1587ZM12 2.72705C10.0848 2.72705 8.24779 3.48805 6.89355 4.84229C5.74705 5.98883 5.0282 7.48168 4.83398 9.07471H5.6875C6.78494 6.68625 9.19544 5.02686 11.9951 5.02686C14.7946 5.02703 17.2044 6.6864 18.3018 9.07471H19.166C18.9718 7.48168 18.2529 5.98883 17.1064 4.84229C15.7522 3.48805 13.9152 2.72705 12 2.72705Z" fill="#34334B"/>
              </svg>
            </span>
          </Link>
        </>
      )}
    </aside>
  )
}
